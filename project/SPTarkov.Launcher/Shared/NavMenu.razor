@using SPTarkov.Core.Mods
@implements IDisposable

@inject LocaleHelper LocaleHelper
@inject StateHelper StateHelper
@inject ModManager ModManager

<MudNavMenu Class="mud-typography-nowrap">
    <MudTooltip Color="Color.Dark" Arrow="false" Placement="Placement.Right" ShowOnHover="true" Text="@(LocaleHelper.Get("home"))" Inline="false">
        <MudNavLink Disabled="!StateHelper.AllowNavigation" IconColor="Color.Default" Icon="@Icons.Material.Filled.ConnectedTv" Match="NavLinkMatch.All" Href="/ServerPageWrapper/false"/>
    </MudTooltip>
</MudNavMenu>
<MudSpacer/>
<MudNavMenu Class="mud-typography-nowrap">
    @if (ModManager.GetDownloadTasks().Any())
    {
        <MudTooltip Color="Color.Dark" Arrow="false" Text="Downloads" Placement="Placement.Right" Inline="false">
            <MudNavLink Disabled="!StateHelper.AllowNavigation" IconColor="Color.Default" Icon="@Icons.Material.Filled.Downloading" OnClick="ToggleComponent"/>
        </MudTooltip>
    }
    <MudTooltip Color="Color.Dark" Arrow="false" Text="@(LocaleHelper.Get("mod_loader"))" Placement="Placement.Right" Inline="false">
        <MudNavLink Disabled="!StateHelper.AllowNavigation" IconColor="Color.Default" Icon="@Icons.Material.Filled.Reorder" Match="NavLinkMatch.All" Href="/ModLoader"/>
    </MudTooltip>
    <MudTooltip Color="Color.Dark" Arrow="false" Text="Forge" Placement="Placement.Right" Inline="false">
        <MudNavLink Disabled="!StateHelper.AllowNavigation" IconColor="Color.Default" Icon="@Icons.Material.Filled.FolderZip" Match="NavLinkMatch.All" Href="/Forge"/>
    </MudTooltip>
    <MudTooltip Color="Color.Dark" Arrow="false" Text="@(LocaleHelper.Get("settings"))" Placement="Placement.Right" Inline="false">
        <MudNavLink Disabled="!StateHelper.AllowNavigation" IconColor="Color.Default" Icon="@Icons.Material.Filled.Settings" Match="NavLinkMatch.All" Href="/Settings"/>
    </MudTooltip>
    <MudTooltip Color="Color.Dark" Arrow="false" Text="@(LocaleHelper.Get("info"))" Placement="Placement.Right" Inline="false">
        <MudNavLink Disabled="!StateHelper.AllowNavigation" IconColor="Color.Default" Icon="@Icons.Material.Filled.Info" Match="NavLinkMatch.All" Href="/Info"/>
    </MudTooltip>
</MudNavMenu>

@code
{
    private bool _showDownloadComponent;

    protected override void OnInitialized()
    {
        StateHelper.OnStateChanged += StateHasChanged;
        base.OnInitialized();
    }

    public void Dispose()
    {
        StateHelper.OnStateChanged -= StateHasChanged;
    }

    private void ToggleComponent()
    {
        _showDownloadComponent = !_showDownloadComponent;
        StateHelper.SetShowDownloads(_showDownloadComponent);
    }
}
