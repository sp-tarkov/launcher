@inject NavigationManager NavigationManager

<MudItem sm="6">
    @if (IsSkeleton)
    {
        <MudCard Class="info-card-height mud-background-gray border-2 border-solid mud-border-lines-default">
            <MudCardHeader>
                <CardHeaderAvatar>
                    <MudSkeleton SkeletonType="SkeletonType.Circle" Height="40px" Width="40px"/>
                </CardHeaderAvatar>
                <CardHeaderContent>
                    <MudSkeleton Width="40%"/>
                    <MudSkeleton Width="60%"/>
                </CardHeaderContent>
                <CardHeaderActions>
                    <MudSkeleton SkeletonType="SkeletonType.Circle" Height="30px" Width="30px" Class="ml-2 mb-2"/>
                </CardHeaderActions>
            </MudCardHeader>
            <MudCardContent>
                <MudSkeleton SkeletonType="SkeletonType.Rectangle" Height="150px"/>
            </MudCardContent>
            <MudCardActions>
                <MudSkeleton SkeletonType="SkeletonType.Rectangle" Height="30px" Width="80px"
                             Class="ml-2 mb-2 rounded-pill"/>
                <MudSpacer/>
                <MudSkeleton SkeletonType="SkeletonType.Rectangle" Height="30px" Width="80px"
                             Class="mr-2 mb-2 rounded-pill"/>
            </MudCardActions>
        </MudCard>
    }
    else
    {
        <MudCard Class="info-card-height mud-background-gray border-2 border-solid mud-border-lines-default">
            <MudCardHeader>
                <CardHeaderAvatar>
                    @if (ForgeMod.TryGetProfileAvatar(out var url))
                    {
                        <MudAvatar Style="background-color: transparent !important;">
                            <MudImage Src="@url"/>
                        </MudAvatar>
                    }
                    else
                    {
                        <MudAvatar Color="Color.Secondary">@ForgeMod.GetAvatarLetter()</MudAvatar>
                    }
                </CardHeaderAvatar>
                <CardHeaderContent>
                    <MudText Typo="Typo.body1">@ForgeMod.GetModName()</MudText>
                    <MudText Typo="Typo.body2">By @ForgeMod.GetModdersName()</MudText>
                </CardHeaderContent>
                <CardHeaderActions>
                    @if (ForgeMod.GetModFeatured())
                    {
                        <ToolTip Text="Featured">
                            <MudIconButton Icon="@Icons.Material.Filled.Favorite" Color="Color.Primary"/>
                        </ToolTip>
                    }

                    @* TODO: add one for if ai generated *@
                </CardHeaderActions>
            </MudCardHeader>
            <MudCardContent>
                <MudText Typo="Typo.body2">@ForgeMod.GetModTeaser()</MudText>
            </MudCardContent>
            <MudCardActions Class="pa-4">
                <MudButton StartIcon="@Icons.Material.Filled.ReadMore" Variant="Variant.Filled" Color="Color.Primary"
                           Size="Size.Small" DropShadow="false" @onclick="() => NavigateToSingleMod(ForgeMod.Id)">Read
                    More
                </MudButton>
                <MudSpacer/>
                <MudButton StartIcon="@Icons.Material.Filled.OpenInNew" Variant="Variant.Filled" Color="Color.Success"
                           Size="Size.Small" DropShadow="false"
                           Href="@($"https://forge.sp-tarkov.com/mod/{ForgeMod.Id}/{ForgeMod.Slug}")">Forge
                </MudButton>
            </MudCardActions>
        </MudCard>
    }
</MudItem>

@code {
    [Parameter]
    public bool IsSkeleton { get; set; }

    [Parameter]
    public ForgeBase ForgeMod { get; set; }

    private void NavigateToSingleMod(int? modId)
    {
        // navigate to mod page
        Console.WriteLine($"Navigating to mod page: {modId}");
        NavigationManager.NavigateTo($"/ForgeModPage/{modId}");
    }

}
